{"version":3,"file":"742.js","mappings":"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","sources":["webpack:///./templates/v2-magazine/v2-magazine.js"],"sourcesContent":["import { getMetadata, createOptimizedPicture, buildBlock, decorateBlock, loadBlock } from '../../scripts/aem.js';\nimport { createElement, getTextLabel, getPlaceholders, extractObjectFromArray, MAGAZINE_CONFIGS, getLocale } from '../../scripts/common.js';\n\nconst templateName = 'v2-magazine';\nconst articleHero = `${templateName}-article-hero`;\nconst MQ = window.matchMedia('(width < 1200px)');\nconst dateValues = {\n  mobileDateOptions: null,\n  desktopDateOptions: null,\n  pubDate: null,\n  locale: null,\n  pubDateEl: null,\n};\n\nconst dateFormatter = (date, locale, options) => new Intl.DateTimeFormat(locale, options).format(new Date(date));\n\nconst buildHeroTitle = () => {\n  let title = getMetadata('og:title');\n  if (title.includes('|')) {\n    [title] = title.split(' |');\n  }\n  const heroTitle = createElement('h1', { classes: `${articleHero}__title` });\n  heroTitle.innerText = title;\n  return heroTitle;\n};\n\nconst buildHeroImage = () => {\n  const headPic = getMetadata('og:image');\n  const headAlt = getMetadata('og:image:alt');\n  const headImg = createOptimizedPicture(headPic, headAlt);\n  headImg.classList.add(`${articleHero}__img-container`);\n  return headImg;\n};\n\n// Build the 1st element of the metadata row\nconst buildMetaAuthor = () => {\n  const author = getMetadata('author');\n  const authorSpan = createElement('span', {\n    classes: `${articleHero}--author`,\n    props: { itemprop: 'author' },\n  });\n  authorSpan.innerText = author;\n  return authorSpan;\n};\n\n// Build the 2nd element of the metadata row\nconst buildMetaPubDate = () => {\n  const { DATE_OPTIONS, DATE_OPTIONS_MOBILE } = MAGAZINE_CONFIGS;\n  let pubDate = getMetadata('publish-date');\n  const locale = getLocale();\n  const mobileDateOptions = DATE_OPTIONS_MOBILE ? extractObjectFromArray(JSON.parse(DATE_OPTIONS_MOBILE)) : {};\n  const desktopDateOptions = DATE_OPTIONS ? extractObjectFromArray(JSON.parse(DATE_OPTIONS)) : {};\n  const formatDateOptions = MQ.matches ? mobileDateOptions : desktopDateOptions;\n  const pubDateEl = createElement('date', {\n    classes: `${articleHero}__pubdate`,\n    props: {\n      datetime: new Date(pubDate).toISOString(),\n      itemprop: 'datePublished',\n    },\n  });\n  pubDate = dateFormatter(pubDate, locale, formatDateOptions);\n  pubDateEl.innerText = pubDate;\n  // Set values to be used in resizeObserver\n  dateValues.mobileDateOptions = mobileDateOptions;\n  dateValues.desktopDateOptions = desktopDateOptions;\n  dateValues.pubDate = pubDate;\n  dateValues.locale = locale;\n  dateValues.pubDateEl = pubDateEl;\n  return pubDateEl;\n};\n\n// Build the 3rd element of the metadata row\nconst buildMetaReadTime = () => {\n  const readTime = getMetadata('readingtime');\n  const readTimeSpan = createElement('span', { classes: `${articleHero}__readtime` });\n  readTimeSpan.innerText = `${readTime.split(' ').join('')} ${getTextLabel('v2_magazine:read_time')}`;\n  return readTimeSpan;\n};\n\nconst buildHeroMetadata = () => {\n  const textContainer = createElement('div', { classes: `${articleHero}__metadata-container` });\n  const authorSpan = buildMetaAuthor();\n  const pubDateEl = buildMetaPubDate();\n  const readTimeSpan = buildMetaReadTime();\n  textContainer.append(authorSpan, pubDateEl, readTimeSpan);\n  return textContainer;\n};\n\nconst splitTags = (tags) => tags.split(',').map((tag) => tag.trim());\n\nconst buildHeroTags = () => {\n  const articleCategory = splitTags(getMetadata('article-category'));\n  const topic = splitTags(getMetadata('topic'));\n  const truck = splitTags(getMetadata('truck'));\n  const tags = [...articleCategory, ...topic, ...truck].filter((tag) => tag !== '').sort((a, b) => a.localeCompare(b));\n  if (tags.length > 0 && tags[0] !== '') {\n    const tagList = createElement('ul', { classes: `${articleHero}__tags` });\n    tags.forEach((tag) => {\n      const tagLi = createElement('li', { classes: `${articleHero}__tag` });\n      tagLi.innerText = tag.trim();\n      tagList.append(tagLi);\n    });\n    return tagList;\n  }\n  return null;\n};\n\nconst buildArticleHero = (doc, articleSearchWrapper) => {\n  const main = doc.querySelector('main');\n  const heroContainer = createElement('div', { classes: `${articleHero}__container` });\n  const heroTitle = buildHeroTitle();\n  const headImg = buildHeroImage();\n  const textContainer = buildHeroMetadata();\n  const tagList = buildHeroTags();\n\n  heroContainer.append(heroTitle, headImg, textContainer);\n  if (tagList) {\n    heroContainer.append(tagList);\n  }\n\n  main.setAttribute('itemscope', '');\n  main.setAttribute('itemtype', 'https://schema.org/Article');\n\n  if (articleSearchWrapper) {\n    articleSearchWrapper.insertAdjacentElement('afterend', heroContainer);\n  } else {\n    main.prepend(heroContainer);\n  }\n\n  const resizeObserver = new ResizeObserver((entries) => {\n    const { mobileDateOptions, desktopDateOptions, pubDate, locale, pubDateEl } = dateValues;\n    entries.forEach(() => {\n      const dateOptions = MQ.matches ? mobileDateOptions : desktopDateOptions;\n      pubDateEl.innerText = dateFormatter(pubDate, locale, dateOptions);\n    });\n  });\n  resizeObserver.observe(main);\n};\n\nconst loadArticleSearchBlock = (main) => {\n  const variantClasses = ['default', 'black', 'gray'];\n  const variant = getMetadata('article-search').toLowerCase();\n  const hasArticleSearch = variantClasses.includes(variant);\n\n  if (hasArticleSearch) {\n    const blockName = 'v2-article-search';\n    const isVariant = variantClasses.slice(1).includes(variant);\n    const articleSearchWrapper = createElement('div');\n    const articleSearch = buildBlock(blockName, []);\n    articleSearch.classList.toggle(variant, isVariant);\n    articleSearchWrapper.append(articleSearch);\n    decorateBlock(articleSearch);\n    loadBlock(articleSearch);\n    main.prepend(articleSearchWrapper);\n  }\n};\n\nexport default async function decorate(doc) {\n  await getPlaceholders();\n  const main = doc.querySelector('main');\n  loadArticleSearchBlock(main);\n  const articleSearchWrapper = document.querySelector('.v2-article-search-wrapper');\n  buildArticleHero(doc, articleSearchWrapper);\n}\n"],"names":["articleHero","MQ","window","matchMedia","dateValues","mobileDateOptions","desktopDateOptions","pubDate","locale","pubDateEl","dateFormatter","date","options","Intl","DateTimeFormat","format","Date","buildHeroTitle","title","includes","split","heroTitle","classes","innerText","buildHeroImage","headPic","headAlt","headImg","classList","add","buildMetaAuthor","author","authorSpan","props","itemprop","buildMetaPubDate","DATE_OPTIONS","DATE_OPTIONS_MOBILE","JSON","parse","formatDateOptions","matches","datetime","toISOString","buildMetaReadTime","readTime","readTimeSpan","join","buildHeroMetadata","textContainer","append","splitTags","tags","map","tag","trim","buildHeroTags","filter","sort","a","b","localeCompare","length","tagList","forEach","tagLi","buildArticleHero","doc","articleSearchWrapper","main","querySelector","heroContainer","setAttribute","insertAdjacentElement","prepend","ResizeObserver","entries","dateOptions","observe","loadArticleSearchBlock","variantClasses","variant","toLowerCase","blockName","isVariant","slice","articleSearch","toggle","async","decorate","document"],"sourceRoot":""}